{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://notwillk.mealbook/schemas/menu.schema.json",
  "title": "Mealbook Menu or Restaurant",
  "description": "Allows either a schema.org Menu object or a Restaurant with embedded Menu data.",
  "type": "object",
  "oneOf": [
    {
      "allOf": [
        {
          "properties": {
            "@context": {
              "type": "string",
              "const": "https://schema.org"
            }
          },
          "required": [
            "@context"
          ]
        },
        {
          "$ref": "#/$defs/Menu"
        }
      ]
    },
    {
      "$ref": "#/$defs/Restaurant"
    }
  ],
  "$defs": {
    "Menu": {
      "type": "object",
      "required": [
        "hasMenuSection"
      ],
      "properties": {
        "@context": {
          "type": "string",
          "const": "https://schema.org"
        },
        "@type": {
          "type": "string",
          "const": "Menu"
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "image": {
          "oneOf": [
            {
              "type": "string",
              "format": "uri"
            },
            {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uri"
              },
              "minItems": 1
            }
          ]
        },
        "inLanguage": {
          "type": "string",
          "minLength": 2
        },
        "hasMenuSection": {
          "oneOf": [
            {
              "$ref": "#/$defs/MenuSection"
            },
            {
              "type": "array",
              "items": {
                "$ref": "#/$defs/MenuSection"
              },
              "minItems": 1
            }
          ]
        },
        "hasMenuItem": {
          "oneOf": [
            {
              "$ref": "#/$defs/MenuItem"
            },
            {
              "type": "array",
              "items": {
                "$ref": "#/$defs/MenuItem"
              },
              "minItems": 1
            }
          ]
        },
        "offers": {
          "$ref": "#/$defs/Offer"
        }
      },
      "additionalProperties": false
    },
    "MenuSection": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "@type": {
          "type": "string",
          "const": "MenuSection"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "image": {
          "oneOf": [
            {
              "type": "string",
              "format": "uri"
            },
            {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uri"
              },
              "minItems": 1
            }
          ]
        },
        "offers": {
          "$ref": "#/$defs/Offer"
        },
        "hasMenuItem": {
          "oneOf": [
            {
              "$ref": "#/$defs/MenuItem"
            },
            {
              "type": "array",
              "items": {
                "$ref": "#/$defs/MenuItem"
              },
              "minItems": 1
            }
          ]
        },
        "hasMenuSection": {
          "oneOf": [
            {
              "$ref": "#/$defs/MenuSubSection"
            },
            {
              "type": "array",
              "items": {
                "$ref": "#/$defs/MenuSubSection"
              },
              "minItems": 1
            }
          ]
        }
      },
      "additionalProperties": false
    },
    "MenuSubSection": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "@type": {
          "type": "string",
          "const": "MenuSection"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "image": {
          "oneOf": [
            {
              "type": "string",
              "format": "uri"
            },
            {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uri"
              },
              "minItems": 1
            }
          ]
        },
        "offers": {
          "$ref": "#/$defs/Offer"
        },
        "hasMenuItem": {
          "oneOf": [
            {
              "$ref": "#/$defs/MenuItem"
            },
            {
              "type": "array",
              "items": {
                "$ref": "#/$defs/MenuItem"
              },
              "minItems": 1
            }
          ]
        }
      },
      "additionalProperties": false
    },
    "MenuItem": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "@type": {
          "type": "string",
          "const": "MenuItem"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "image": {
          "oneOf": [
            {
              "type": "string",
              "format": "uri"
            },
            {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uri"
              },
              "minItems": 1
            }
          ]
        },
        "nutrition": {
          "$ref": "#/$defs/NutritionInformation"
        },
        "offers": {
          "$ref": "#/$defs/Offer"
        },
        "suitableForDiet": {
          "type": "string",
          "anyOf": [
            {
              "enum": [
                "DiabeticDiet",
                "GlutenFreeDiet",
                "HalalDiet",
                "KosherDiet",
                "LowCalorieDiet",
                "LowFatDiet",
                "LowLactoseDiet",
                "LowSaltDiet",
                "VeganDiet",
                "VegetarianDiet"
              ]
            },
            {
              "pattern": "^https://schema\\.org/[^\\s]+$"
            }
          ]
        }
      },
      "additionalProperties": false
    },
    "Restaurant": {
      "type": "object",
      "required": [
        "@context",
        "name",
        "hasMenu"
      ],
      "properties": {
        "@context": {
          "type": "string",
          "const": "https://schema.org"
        },
        "@type": {
          "type": "string",
          "const": "Restaurant"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "url": {
          "type": "string",
          "format": "uri"
        },
        "image": {
          "oneOf": [
            {
              "type": "string",
              "format": "uri"
            },
            {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uri"
              },
              "minItems": 1
            }
          ]
        },
        "servesCuisine": {
          "oneOf": [
            {
              "type": "string",
              "minLength": 1
            },
            {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1
            }
          ]
        },
        "hasMenu": {
          "oneOf": [
            {
              "$ref": "#/$defs/Menu"
            },
            {
              "type": "array",
              "items": {
                "$ref": "#/$defs/Menu"
              },
              "minItems": 1
            }
          ]
        }
      },
      "additionalProperties": false
    },
    "Offer": {
      "type": "object",
      "required": [],
      "properties": {
        "@type": {
          "type": "string",
          "const": "Offer"
        },
        "price": {
          "type": [
            "string",
            "number"
          ]
        },
        "priceCurrency": {
          "type": "string",
          "minLength": 1
        },
        "availabilityStarts": {
          "type": "string",
          "minLength": 1
        },
        "availabilityEnds": {
          "type": "string",
          "minLength": 1
        }
      },
      "additionalProperties": false
    },
    "NutritionInformation": {
      "type": "object",
      "required": [],
      "properties": {
        "@type": {
          "type": "string",
          "const": "NutritionInformation"
        },
        "calories": {
          "type": "string"
        },
        "fatContent": {
          "type": "string"
        },
        "fiberContent": {
          "type": "string"
        },
        "proteinContent": {
          "type": "string"
        }
      },
      "additionalProperties": false
    }
  }
}
