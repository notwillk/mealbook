#!/usr/bin/env bash
set -euo pipefail

ROOT_DIR="$(git rev-parse --show-toplevel)"
cd "$ROOT_DIR"

if upstream=$(git rev-parse --abbrev-ref --symbolic-full-name @{upstream} 2>/dev/null); then
  base="$(git merge-base HEAD "$upstream")"
else
  root_commit="$(git rev-list --max-parents=0 HEAD | tail -n1)"
  base="$root_commit"
fi

./scripts/validate_changes.sh "$base" HEAD
